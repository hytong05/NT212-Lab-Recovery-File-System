# FAT Recovery Tool

A comprehensive tool for analyzing and recovering FAT16/FAT32 boot sectors, available in both monolithic and modular versions.

## ğŸš€ Quick Start

### Basic Usage
```bash
# Using original monolithic version
python fat_recovery.py E --recovery

# Using modular version  
python fat_recovery_modular.py E --recovery

# Info only mode
python fat_recovery_modular.py F --info-only
```

### Demo & Testing
```bash
python demo_modular.py    # Run demo
python test_modules.py    # Run unit tests
make demo                 # Using Makefile
make test                 # Run tests via Makefile
```

## ğŸ“ Project Structure

```
FAT-Recovery-Tool/
â”œâ”€â”€ ğŸ“„ Core Files
â”‚   â”œâ”€â”€ fat_recovery.py              # Original monolithic version (607 lines)
â”‚   â””â”€â”€ fat_recovery_modular.py      # Modular entry point
â”œâ”€â”€ ğŸ§© Modular Components  
â”‚   â”œâ”€â”€ constants.py                 # System constants & configuration
â”‚   â”œâ”€â”€ disk_utils.py               # Disk read/write utilities
â”‚   â”œâ”€â”€ boot_sector.py              # Boot sector processing
â”‚   â”œâ”€â”€ fat_analyzer.py             # Core analysis & recovery logic
â”‚   â”œâ”€â”€ cli.py                      # Command line interface
â”‚   â”œâ”€â”€ main.py                     # Alternative entry point
â”‚   â””â”€â”€ __init__.py                 # Package initialization
â”œâ”€â”€ ğŸ§ª Testing & Demo
â”‚   â”œâ”€â”€ test_modules.py             # Unit tests
â”‚   â””â”€â”€ demo_modular.py             # Feature demonstration
â”œâ”€â”€ ğŸ“š Documentation
â”‚   â”œâ”€â”€ README_modular.md           # Modular version guide
â”‚   â”œâ”€â”€ ANALYSIS_SUMMARY.md         # Modularization analysis
â”‚   â”œâ”€â”€ PROJECT_INDEX.md            # Project index
â”‚   â””â”€â”€ requirements.txt            # Dependencies
â”œâ”€â”€ ğŸ› ï¸ Build & Data
â”‚   â”œâ”€â”€ Makefile                    # Build automation
â”‚   â””â”€â”€ Bonus_Lab.vhd              # Test virtual disk
```

## ğŸ—ï¸ Architecture Overview

### Module Dependencies
```
fat_recovery_modular.py
â””â”€â”€ cli.py
    â””â”€â”€ fat_analyzer.py
        â”œâ”€â”€ boot_sector.py
        â”‚   â”œâ”€â”€ constants.py
        â”‚   â””â”€â”€ disk_utils.py
        â””â”€â”€ disk_utils.py
            â””â”€â”€ constants.py
```

### Key Components

#### 1. **Constants Module** (`constants.py`)
- Boot signature definitions
- Valid sector sizes and cluster counts
- IOCTL codes and system configurations

#### 2. **Disk Utilities** (`disk_utils.py`)
```python
class DiskReader:
    def read_sector(sector_num, num_sectors=1)    # Read disk sectors
    def write_sector(sector_num, data)            # Write to disk
    def get_disk_size()                           # Multi-method size detection
```

#### 3. **Boot Sector Processing** (`boot_sector.py`)
```python
class BootSectorParser:
    def parse_boot_sector(data)                   # Extract boot sector info
    
class BootSectorValidator:
    def validate_boot_sector(info, disk_size=0)   # Validate boot sector
    
class BootSectorGenerator:
    def generate_optimal_boot_sector(damaged, disk_size=0)  # Generate new boot sector
```

#### 4. **FAT Analyzer** (`fat_analyzer.py`)
```python
class FATAnalyzer:
    def run_analysis()                           # Comprehensive analysis
    def repair_boot_sector()                     # Repair damaged boot sector
    def _display_boot_sector_info()              # Display detailed info
```

#### 5. **CLI Interface** (`cli.py`)
```python
class FATRecoveryCLI:
    def run(args=None)                           # Main CLI entry point
    def _handle_recovery()                       # Handle recovery operations
```

## ğŸ’» Usage Examples

### Command Line Interface
```bash
# Analyze drive E:
python fat_recovery_modular.py E

# Analyze and recover drive D:
python fat_recovery_modular.py D --recovery

# Information only mode
python fat_recovery_modular.py F --info-only
```

### Programmatic API

#### High-level API
```python
from fat_analyzer import FATAnalyzer

# Create analyzer instance
analyzer = FATAnalyzer('E')

# Run comprehensive analysis
result = analyzer.run_analysis()

# Repair if needed
if result['recovery_needed']:
    success = analyzer.repair_boot_sector()
```

#### Mid-level API
```python
from boot_sector import BootSectorParser, BootSectorValidator
from disk_utils import DiskReader

# Read and parse boot sector
reader = DiskReader('E')
data = reader.read_sector(0)
info = BootSectorParser.parse_boot_sector(data)

# Validate boot sector
errors = BootSectorValidator.validate_boot_sector(info)
```

#### Low-level API
```python
from disk_utils import DiskReader

reader = DiskReader('E')
data = reader.read_sector(0)           # Read boot sector
size = reader.get_disk_size()          # Get disk size
reader.write_sector(0, new_data)       # Write new boot sector
```

## ğŸ” Key Features

- âœ… **Multi-FAT Support**: FAT12/16/32 compatibility
- âœ… **Smart Detection**: Multi-method disk size detection
- âœ… **Interactive Recovery**: User-guided repair process
- âœ… **Automatic Backup**: Safe recovery with backups
- âœ… **Comprehensive Validation**: Thorough boot sector checking
- âœ… **Cross-platform**: Windows/Linux compatible
- âœ… **Well-documented**: Complete API documentation
- âœ… **Modular Design**: Reusable components

## ğŸ“Š Comparison: Monolithic vs Modular

| Aspect | Original File | Modular Version |
|--------|---------------|-----------------|
| **Structure** | 1 file, 607 lines | 7 files, ~540 lines |
| **Maintainability** | âš ï¸ Difficult | âœ… Easy |
| **Testability** | âŒ Hard to test individually | âœ… Easy unit testing |
| **Reusability** | âŒ Must copy entire file | âœ… Import specific components |
| **Readability** | âš ï¸ Good | âœ… Excellent |
| **Extensibility** | âŒ Hard to extend | âœ… Easy to extend |
| **Documentation** | âš ï¸ Basic | âœ… Comprehensive |
| **Type Hints** | âš ï¸ Partial | âœ… Complete |

## ğŸ¯ Use Cases

1. **System Administrators**: Recover corrupted FAT boot sectors
2. **Forensics Experts**: Analyze FAT file system structure
3. **Developers**: Use components in other projects
4. **Students**: Learn about FAT file system internals
5. **Data Recovery**: Professional data recovery operations

## ğŸ§ª Testing

### Run Tests
```bash
python test_modules.py    # Run all unit tests
make test                 # Using Makefile
```

### Run Demo
```bash
python demo_modular.py    # Interactive demonstration
make demo                 # Using Makefile
```

## ğŸ“¦ Installation & Requirements

### Dependencies
```bash
pip install -r requirements.txt
```

### System Requirements
- Python 3.6+
- pywin32 (optional, for Windows disk access)
- Standard library: struct, os, sys, argparse, typing

### Virtual Environment (Recommended)
```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
pip install -r requirements.txt
```

## ğŸ”§ Development

### Build Commands
```bash
make demo     # Run demonstration
make test     # Run unit tests
make clean    # Clean up temporary files
```

### Adding New Features
1. Create new module in appropriate category
2. Add tests in `test_modules.py`
3. Update documentation
4. Test with `demo_modular.py`

## ğŸ‰ Benefits of Modularization

1. **Separation of Concerns**: Each module has a clear responsibility
2. **High Cohesion, Low Coupling**: Well-structured dependencies
3. **Enhanced Testability**: Individual component testing
4. **Improved Maintainability**: Easier bug fixes and updates
5. **Code Reusability**: Components can be used in other projects
6. **Better Documentation**: Clear API for each module
7. **Extensibility**: Easy to add new file system support

## ğŸ”® Future Enhancements

- [ ] **Logging Module**: Comprehensive logging system
- [ ] **Configuration Files**: External configuration support
- [ ] **Plugin Architecture**: Extensible plugin system
- [ ] **GUI Interface**: Graphical user interface
- [ ] **Extended Support**: exFAT, NTFS support
- [ ] **Parallel Processing**: Multi-threaded operations
- [ ] **Network Drives**: Remote disk support
- [ ] **Recovery Wizard**: Step-by-step recovery guide

## ğŸš¨ Important Notes

- **Administrator Rights**: Required for direct disk access
- **Backup First**: Always backup before recovery operations
- **Test Environment**: Use test VHD files for experimentation
- **Data Safety**: Tool creates automatic backups during recovery

## ğŸ“„ License & Support

**Version**: 1.0.0  
**Date**: June 2025  
**Authors**: FAT Recovery Tool Team

For issues, suggestions, or contributions, please refer to the project documentation or contact the development team.

---
*This tool is designed for educational and professional data recovery purposes. Always ensure proper backups before performing recovery operations on critical data.*
